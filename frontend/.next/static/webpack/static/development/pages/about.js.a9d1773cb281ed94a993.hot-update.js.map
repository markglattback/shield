{"version":3,"file":"static/webpack/static\\development\\pages\\about.js.a9d1773cb281ed94a993.hot-update.js","sources":["webpack:///./lib/withAuth.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport cookies from 'next-cookies';\r\nimport Router from 'next/router';\r\n\r\n// Gets the display name of a JSX component for dev tools\r\nconst getDisplayName = WrappedComponent => WrappedComponent.displayName || WrappedComponent.name || 'Component';\r\n\r\nconst _withAuth = WrappedComponent => class withAuth extends Component {\r\n  static displayname = `withAuth(${getDisplayName(WrappedComponent)})`;\r\n\r\n  static async getInitialProps(ctx) {\r\n    const { token } = cookies(ctx);\r\n\r\n    // Server side only\r\n    if (ctx.req && !token) {\r\n      // redirect to login page if no token present\r\n      ctx.res.writeHead(302, { Location: '/login' });\r\n      ctx.res.end();\r\n    }\r\n\r\n    const componentProps = WrappedComponent.getInitialProps && await WrappedComponent.getInitialProps(ctx);\r\n\r\n    return { ...componentProps };\r\n  }\r\n\r\n  handleError = (error) => {\r\n    // redirect if UNAUTHENTICATED\r\n    if (error.message === 'GraphQL error: You must be logged in to view this content') {\r\n      if (typeof window !== 'undefined') {\r\n        Router.push('/login');\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <WrappedComponent {...this.props} onError={this.handleError} />;\r\n  }\r\n};\r\n\r\nexport default _withAuth;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AACA;AADA;AACA;AADA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;AAAA;AACA;AADA;AAAA;AAAA;AA4BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AA7BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAZA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAaA;AAbA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AA+BA;;;;A","sourceRoot":""}