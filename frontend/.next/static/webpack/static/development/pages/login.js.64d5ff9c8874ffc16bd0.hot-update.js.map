{"version":3,"file":"static/webpack/static\\development\\pages\\login.js.64d5ff9c8874ffc16bd0.hot-update.js","sources":["webpack:///./pages/login.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport Router from 'next/router';\r\nimport gql from 'graphql-tag';\r\nimport { Mutation } from 'react-apollo';\r\n\r\nconst LOGIN = gql`\r\n  mutation LOGIN($email: String!, $password: String!) {\r\n    LOGIN(email: $email, password: $password) {\r\n      id\r\n      firstName\r\n      roles\r\n    }\r\n  }\r\n`;\r\n\r\nconst GET_USER = gql`\r\n  query GET_USER {\r\n    id\r\n    firstName\r\n    roles\r\n  }\r\n`;\r\n\r\nclass Login extends Component {\r\n  state = {\r\n    email: '',\r\n    password: '',\r\n    message: '',\r\n  }\r\n\r\n  handleChange = ({ target: { name, value } }) => {\r\n    this.setState({\r\n      [`${name}`]: value,\r\n    });\r\n  }\r\n\r\n  handleError = (error) => {\r\n    if (error.message === 'GraphQL error: Authentication unsuccessful') {\r\n      this.setState({\r\n        message: 'There was a problem.'\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { state: { email, password } } = this;\r\n\r\n    return (\r\n      <Mutation\r\n        mutation={LOGIN}\r\n        onError={this.handleError}\r\n        update={(cache, { data: { LOGIN: login } }) => {\r\n          console.log(login);\r\n          cache.writeQuery({\r\n            query: GET_USER,\r\n            data: login,\r\n          });\r\n\r\n          Router.push('/');\r\n        }}\r\n      >\r\n        {login => (\r\n          <div>\r\n            <form\r\n              onSubmit={(e) => {\r\n                e.preventDefault();\r\n\r\n                login({ variables: { email, password } });\r\n              }}\r\n            >\r\n              <input type=\"text\" name=\"email\" onChange={this.handleChange} value={email} />\r\n              <input type=\"password\" name=\"password\" onChange={this.handleChange} value={password} />\r\n              <button type=\"submit\">Login</button>\r\n            </form>\r\n            {this.state.message && <p>{this.state.message}</p>}\r\n          </div>\r\n        )}\r\n      </Mutation>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AAUA;AACA;AAOA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;;;;;;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAGA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAbA;AAkBA;;;;AAxDA;AACA;AA0DA;;;;A","sourceRoot":""}